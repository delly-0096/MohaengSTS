<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.ddit.mohaeng.login.mapper.IMemberMapper">

	<resultMap type="kr.or.ddit.mohaeng.vo.MemberVO" id="memberMap">
		<id property="memNo" column="MEM_NO"/>
		<result property="memNo" column="MEM_NO"/>
		<result property="memId" column="MEM_ID"/>
		<result property="memPassword" column="MEM_PASSWORD"/>
		<result property="memName" column="MEM_NAME"/>
		<result property="memEmail" column="MEM_EMAIL"/>
		<result property="memProfile" column="MEM_PROFILE"/>
		<result property="point" column="POINT"/>
		<result property="memStatus" column="MEM_STATUS"/>
		<result property="delYn" column="DEL_YN"/>
		<result property="wdrwResn" column="WDRW_RESN"/>
		<result property="enabled" column="ENABLED"/>
		<result property="memSnsYn" column="MEM_SNS_YN"/>
		<result property="snsType" column="SNS_TYPE"/>
		<result property="snsId" column="SNS_ID"/>
		<result property="regDt" column="REG_DT"/>
		<result property="udtDt" column="UDT_DT"/>
		<result property="wdrwDt" column="WDRW_DT"/>
		<collection property="authList" resultMap="authMap"/>
	</resultMap>

	<!-- 로그인 시 id 매핑 -->
	<select id="selectByMemId" parameterType="string" resultType="kr.or.ddit.mohaeng.vo.MemberVO">
		SELECT MEM_NO as memNo,
		       MEM_ID as memId,
		       MEM_PASSWORD as memPassword,
		       MEM_NAME as memName
		FROM MEMBER
		WHERE MEM_ID = #{memId}
    </select>
    
    <!-- security & jwt용 id 매핑 -->
    <resultMap type="kr.or.ddit.mohaeng.vo.MemberAuthVO" id="authMap">
		<result property="memAuthNo" column="MEM_AUTH_NO"/>
		<result property="memNo" column="MEM_NO"/>
		<result property="auth" column="AUTH"/>
		<result property="regDt" column="REG_DT"/>
	</resultMap>
	
    <select id="selectById" parameterType="string" resultMap="memberMap">
    	SELECT M.MEM_NO, MEM_ID, MEM_PASSWORD, MEM_NAME, AUTH
    	  FROM MEMBER M LEFT OUTER JOIN MEMBER_AUTH MA ON(M.MEM_NO = MA.MEM_NO)
    	 WHERE M.MEM_ID = #{username}
    </select>
    
</mapper>